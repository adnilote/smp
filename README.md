# Cryptochat with Social Millionaire protocol - Zero-knowledge proof
https://bitbucket.org/Enr1g/p2p_mpotr.js/src


В работе рассматривается задача взаимной аутентификации
пользователей для криптографических чатов групповых коммуникаций, по-
строенных на основе асимметричных шифрсистем, основной уязвимостью ко-
торых является возможность осуществления подмены открытого ключа одно-
го из участников на другой открытый ключ с известной противнику секрет-
ной половиной этого ключа (атака ѕчеловек в серединеї). В таких случаях
протоколы типа Диффи-Хеллмана не применимы для надежного решения
задачи аутентификации, и в различных системах используют дополнитель-
ный слой аутентификации с помощью алгоритмов решения задач с нулевым
разглашением (ZKP - zero knowledge problem). Доказательством с нулевым
разглашением называется интерактивный вероятностный протокол, который
позволяет убедиться одной из сторон (Проверяющему) в достоверности неко-
го утверждения, без предоставления второй стороне (Доказывающей) дока-
зательств о самом утверждении.

В работе был исследован протокол SMP Socialist Millionaire Protocol,
или протокол миллионеров-социалистов, позволяющий двум пользователям
аутентифицировать друг друга с помощью общего пароля [1]. Оригинальный
протокол миллионеров-социалистов позволяет проверить знание некоторого
секрета друг у друга, не разглашая никакой информации об этом секрете,
что позволяет противостоять атаке ѕчеловека в середине.

В работе была предложена модификация протокола для случая N клиен-
тов, где N > 2  протокол круговой аутентификации. Основная идея прото-
кола заключается в транзитивности аутентификации: если первый участник
аутентичен для второго, а второй для третьего, то первый аутентичен для
третьего. Данное предположение допустимо, так как аутентичность участ-
ника определяется его знанием пароля, о котором договорились участники
беседы, поэтому случай, когда участник решит поделиться с другим чело-
веком паролем не рассматривается. Алгоритм круговой аутентификации за-
ключается в следующем: участники организуют ориентированное кольцо и
инициирует аутентификацию следующего за ним участника с помощью про-
токола миллионеров-социалистов. В зависимости от результата аутентифика-
ции сохраняют проверенного участника в таблицу доверенных пользователей
или таблицу нарушителей и рассылают таблицы всем участникам. Пользова-
тель обновляет свои таблицы доверенных и нарушителей только если полу-
чает результаты аутентификации от доверенных пользователей. Таким обра-
зом участник получает информацию об аутентичности других пользователей,
не аутентифицировав их самим. Участник аутентифицирует следующего не
аутентифицированного участника до тех пор, пока не будет проведена успеш-
ная инициализация аутентификации. После этого участник будет работать
только на прием сообщений и обновление таблиц. Алгоритм завершается, ко-
гда аутентичность всех участников становится известна.

Предложенный алгоритм групповой взаимной аутентификации был реа-
лизован для распределенного криптографического чата групповых коммуни-
каций mpOTR, разрабатываемого в ЛБИС [2]. Для оценки экспериментально
время сходимости алгоритма было проведено тестирование для различного
числа участников и его сравнительный анализ с простой реализацией про-
токола миллионеров-социалистов для группы, при которой каждый участ-
ник аутентифицирует каждого. Экспериментальное исследование показало
эффективность использования предложенного протокола круговой аутенти-
фикации  выигрыш в скорости работы примерно в 3 раза по сравнению с
другим алгоритмом. Так же был проведен анализ устойчивости такого прото-
кола аутентификации к наиболее очевидным атакам.
